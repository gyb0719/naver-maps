# Google Sheets 백업 시스템 활성화 가이드

## 🚀 즉시 사용 가능한 Google Sheets 백업 설정

### **1단계: Google Cloud Console 설정**

1. **Google Cloud Console 접속**
   - https://console.cloud.google.com/ 접속
   - Google 계정으로 로그인

2. **프로젝트 선택/생성**
   - 기존 프로젝트 선택 또는 "새 프로젝트" 생성
   - 프로젝트 이름: "네이버지도필지관리" (또는 원하는 이름)

3. **Google Sheets API 활성화**
   - 좌측 메뉴 → "API 및 서비스" → "라이브러리"
   - "Google Sheets API" 검색하여 선택
   - "사용" 버튼 클릭

4. **Drive API 활성화** (필요시)
   - "Google Drive API" 검색하여 선택
   - "사용" 버튼 클릭

### **2단계: OAuth 2.0 클라이언트 ID 생성**

1. **사용자 인증 정보 생성**
   - "API 및 서비스" → "사용자 인증 정보"
   - "사용자 인증 정보 만들기" → "OAuth 2.0 클라이언트 ID"

2. **동의 화면 구성** (처음인 경우)
   - "외부" 선택 → "만들기"
   - 앱 이름: "네이버지도 필지관리"
   - 사용자 지원 이메일: 본인 이메일
   - 개발자 연락처: 본인 이메일
   - "저장 후 계속" 클릭

3. **OAuth 클라이언트 ID 설정**
   - 애플리케이션 유형: "웹 애플리케이션"
   - 이름: "네이버지도필지관리"
   - 승인된 JavaScript 출처:
     ```
     http://localhost:5000
     http://127.0.0.1:5000
     ```
   - 승인된 리디렉션 URI:
     ```
     http://localhost:5000
     http://127.0.0.1:5000
     ```

4. **클라이언트 ID 복사**
   - 생성된 클라이언트 ID를 복사 (예: `506368463001-xxxxx.apps.googleusercontent.com`)

### **3단계: 환경 변수 업데이트**

현재 `.env` 파일에 클라이언트 ID가 있지만, 업데이트가 필요할 수 있습니다:

```bash
# .env 파일에서 확인/수정
GOOGLE_CLIENT_ID=506368463001-um0b25os2vlep7mumonf63pcm9c9a0n3.apps.googleusercontent.com
```

### **4단계: 즉시 테스트**

1. **서버 재시작** (환경 변수 적용)
   ```bash
   # 현재 서버 종료 후 재시작
   node server.js
   ```

2. **브라우저 테스트**
   - http://localhost:5000 접속
   - 필지 데이터 몇 개 입력
   - "구글 시트 전송" 버튼 클릭
   - Google 로그인 후 백업 테스트

### **5단계: 자동 백업 활성화**

Google 로그인 성공 후, 자동 백업이 5분마다 실행됩니다:

- **수동 백업**: "구글 시트 전송" 버튼
- **자동 백업**: 5분마다 자동 실행
- **실패시 증가**: 실패 시 간격이 점진적으로 증가 (최대 30분)

### **현재 백업 시스템 기능**

✅ **이미 구현된 기능들**:
- Google OAuth 2.0 인증
- Google Sheets API 연동
- 자동 스프레드시트 생성
- 배치 데이터 업로드 (1000개씩)
- 실패 시 재시도 로직
- 5분마다 자동 백업

✅ **백업 데이터 형식**:
- 필지 정보 (지번, 소유자, 주소, 연락처)
- 메모 정보
- 색상 및 상태 정보
- 타임스탬프

### **문제 해결**

1. **"리디렉션 URI 불일치" 오류**
   - Google Cloud Console에서 승인된 URI 다시 확인
   - http://localhost:5000 정확히 입력되었는지 확인

2. **"API 키 오류"**
   - `.env` 파일의 GOOGLE_CLIENT_ID 확인
   - 서버 재시작 후 다시 시도

3. **"권한 없음" 오류**
   - Google Sheets API가 활성화되었는지 확인
   - OAuth 동의 화면에서 스코프 확인

### **보안 참고사항**

- 클라이언트 ID는 공개되어도 안전함 (클라이언트 시크릿과 다름)
- OAuth 2.0으로 사용자가 직접 Google에 로그인
- API 키는 서버에서 안전하게 관리됨

이제 Google Sheets 백업이 완전히 활성화됩니다! 🎉